import{t as Ft,r as it,a as Re,c as Ot,o as rt,n as st,w as q,g as De,h as ot,i as Ct,b as at,d as O,e as At,f as Mt,j as W,s as j,k as lt,l as Be,u as Rt}from"./vue-vendor.j4UHwgIf.js";function Le(i){return At()?(Mt(i),!0):!1}const we=new WeakMap,Dt=(...i)=>{var e;const t=i[0],n=(e=De())==null?void 0:e.proxy;if(n==null&&!ot())throw new Error("injectLocal must be called in setup");return n&&we.has(n)&&t in we.get(n)?we.get(n)[t]:Ct(...i)},ut=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Lt=i=>i!=null,zt=Object.prototype.toString,Pt=i=>zt.call(i)==="[object Object]",H=()=>{},Je=Vt();function Vt(){var i,e;return ut&&((i=window==null?void 0:window.navigator)==null?void 0:i.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((e=window==null?void 0:window.navigator)==null?void 0:e.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function ze(i,e){function t(...n){return new Promise((r,o)=>{Promise.resolve(i(()=>e.apply(this,n),{fn:e,thisArg:this,args:n})).then(r).catch(o)})}return t}const ct=i=>i();function dt(i,e={}){let t,n,r=H;const o=l=>{clearTimeout(l),r(),r=H};let s;return l=>{const u=O(i),d=O(e.maxWait);return t&&o(t),u<=0||d!==void 0&&d<=0?(n&&(o(n),n=null),Promise.resolve(l())):new Promise((f,h)=>{r=e.rejectOnCancel?h:f,s=l,d&&!n&&(n=setTimeout(()=>{t&&o(t),n=null,f(s())},d)),t=setTimeout(()=>{n&&o(n),n=null,f(l())},u)})}}function jt(...i){let e=0,t,n=!0,r=H,o,s,a,l,u;!at(i[0])&&typeof i[0]=="object"?{delay:s,trailing:a=!0,leading:l=!0,rejectOnCancel:u=!1}=i[0]:[s,a=!0,l=!0,u=!1]=i;const d=()=>{t&&(clearTimeout(t),t=void 0,r(),r=H)};return h=>{const v=O(s),p=Date.now()-e,y=()=>o=h();return d(),v<=0?(e=Date.now(),y()):(p>v&&(l||!n)?(e=Date.now(),y()):a&&(o=new Promise((g,E)=>{r=u?E:g,t=setTimeout(()=>{e=Date.now(),n=!0,g(y()),d()},Math.max(0,v-p))})),!l&&!t&&(t=setTimeout(()=>n=!0,v)),n=!1,o)}}function Wt(i=ct,e={}){const{initialState:t="active"}=e,n=Pe(t==="active");function r(){n.value=!1}function o(){n.value=!0}const s=(...a)=>{n.value&&i(...a)};return{isActive:it(n),pause:r,resume:o,eventFilter:s}}function Ke(i){return i.endsWith("rem")?Number.parseFloat(i)*16:Number.parseFloat(i)}function $t(i){return De()}function ce(i){return Array.isArray(i)?i:[i]}function Pe(...i){if(i.length!==1)return Ft(...i);const e=i[0];return typeof e=="function"?it(Ot(()=>({get:e,set:H}))):Re(e)}function Bt(i,e=200,t={}){return ze(dt(e,t),i)}function Jt(i,e=200,t=!1,n=!0,r=!1){return ze(jt(e,t,n,r),i)}function ft(i,e,t={}){const{eventFilter:n=ct,...r}=t;return q(i,ze(n,e),r)}function Kt(i,e,t={}){const{eventFilter:n,initialState:r="active",...o}=t,{eventFilter:s,pause:a,resume:l,isActive:u}=Wt(n,{initialState:r});return{stop:ft(i,e,{...o,eventFilter:s}),pause:a,resume:l,isActive:u}}function pe(i,e=!0,t){$t()?rt(i,t):e?i():st(i)}function Xn(i,e,t={}){const{debounce:n=0,maxWait:r=void 0,...o}=t;return ft(i,e,{...o,eventFilter:dt(n,{maxWait:r})})}function Ht(i,e,t){return q(i,e,{...t,immediate:!0})}function Zn(i,e,t){let n;at(t)?n={evaluating:t}:n={};const{lazy:r=!1,evaluating:o=void 0,shallow:s=!0,onError:a=H}=n,l=j(!r),u=s?j(e):Re(e);let d=0;return lt(async f=>{if(!l.value)return;d++;const h=d;let v=!1;o&&Promise.resolve().then(()=>{o.value=!0});try{const p=await i(y=>{f(()=>{o&&(o.value=!1),v||y()})});h===d&&(u.value=p)}catch(p){a(p)}finally{o&&h===d&&(o.value=!1),v=!0}}),r?W(()=>(l.value=!0,u.value)):u}const $=ut?window:void 0;function ge(i){var e;const t=O(i);return(e=t==null?void 0:t.$el)!=null?e:t}function B(...i){const e=[],t=()=>{e.forEach(a=>a()),e.length=0},n=(a,l,u,d)=>(a.addEventListener(l,u,d),()=>a.removeEventListener(l,u,d)),r=W(()=>{const a=ce(O(i[0])).filter(l=>l!=null);return a.every(l=>typeof l!="string")?a:void 0}),o=Ht(()=>{var a,l;return[(l=(a=r.value)==null?void 0:a.map(u=>ge(u)))!=null?l:[$].filter(u=>u!=null),ce(O(r.value?i[1]:i[0])),ce(Rt(r.value?i[2]:i[1])),O(r.value?i[3]:i[2])]},([a,l,u,d])=>{if(t(),!(a!=null&&a.length)||!(l!=null&&l.length)||!(u!=null&&u.length))return;const f=Pt(d)?{...d}:d;e.push(...a.flatMap(h=>l.flatMap(v=>u.map(p=>n(h,v,p,f)))))},{flush:"post"}),s=()=>{o(),t()};return Le(t),s}function Gt(){const i=j(!1),e=De();return e&&rt(()=>{i.value=!0},e),i}function Ut(i){const e=Gt();return W(()=>(e.value,!!i()))}function Yt(i){return typeof i=="function"?i:typeof i=="string"?e=>e.key===i:Array.isArray(i)?e=>i.includes(e.key):()=>!0}function ei(...i){let e,t,n={};i.length===3?(e=i[0],t=i[1],n=i[2]):i.length===2?typeof i[1]=="object"?(e=!0,t=i[0],n=i[1]):(e=i[0],t=i[1]):(e=!0,t=i[0]);const{target:r=$,eventName:o="keydown",passive:s=!1,dedupe:a=!1}=n,l=Yt(e);return B(r,o,d=>{d.repeat&&O(a)||l(d)&&t(d)},s)}const qt=Symbol("vueuse-ssr-width");function Qt(){const i=ot()?Dt(qt,null):null;return typeof i=="number"?i:void 0}function ht(i,e={}){const{window:t=$,ssrWidth:n=Qt()}=e,r=Ut(()=>t&&"matchMedia"in t&&typeof t.matchMedia=="function"),o=j(typeof n=="number"),s=j(),a=j(!1),l=u=>{a.value=u.matches};return lt(()=>{if(o.value){o.value=!r.value;const u=O(i).split(",");a.value=u.some(d=>{const f=d.includes("not all"),h=d.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),v=d.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let p=!!(h||v);return h&&p&&(p=n>=Ke(h[1])),v&&p&&(p=n<=Ke(v[1])),f?!p:p});return}r.value&&(s.value=t.matchMedia(O(i)),a.value=s.value.matches)}),B(s,"change",l,{passive:!0}),W(()=>a.value)}const se=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},oe="__vueuse_ssr_handlers__",Xt=Zt();function Zt(){return oe in se||(se[oe]=se[oe]||{}),se[oe]}function mt(i,e){return Xt[i]||e}function en(i){return ht("(prefers-color-scheme: dark)",i)}function tn(i){return i==null?"any":i instanceof Set?"set":i instanceof Map?"map":i instanceof Date?"date":typeof i=="boolean"?"boolean":typeof i=="string"?"string":typeof i=="object"?"object":Number.isNaN(i)?"any":"number"}const nn={boolean:{read:i=>i==="true",write:i=>String(i)},object:{read:i=>JSON.parse(i),write:i=>JSON.stringify(i)},number:{read:i=>Number.parseFloat(i),write:i=>String(i)},any:{read:i=>i,write:i=>String(i)},string:{read:i=>i,write:i=>String(i)},map:{read:i=>new Map(JSON.parse(i)),write:i=>JSON.stringify(Array.from(i.entries()))},set:{read:i=>new Set(JSON.parse(i)),write:i=>JSON.stringify(Array.from(i))},date:{read:i=>new Date(i),write:i=>i.toISOString()}},He="vueuse-storage";function Ve(i,e,t,n={}){var r;const{flush:o="pre",deep:s=!0,listenToStorageChanges:a=!0,writeDefaults:l=!0,mergeDefaults:u=!1,shallow:d,window:f=$,eventFilter:h,onError:v=S=>{console.error(S)},initOnMounted:p}=n,y=(d?j:Re)(typeof e=="function"?e():e),g=W(()=>O(i));if(!t)try{t=mt("getDefaultStorage",()=>{var S;return(S=$)==null?void 0:S.localStorage})()}catch(S){v(S)}if(!t)return y;const E=O(e),N=tn(E),P=(r=n.serializer)!=null?r:nn[N],{pause:C,resume:A}=Kt(y,()=>_(y.value),{flush:o,deep:s,eventFilter:h});q(g,()=>F(),{flush:o}),f&&a&&pe(()=>{t instanceof Storage?B(f,"storage",F,{passive:!0}):B(f,He,L),p&&F()}),p||F();function M(S,b){if(f){const c={key:g.value,oldValue:S,newValue:b,storageArea:t};f.dispatchEvent(t instanceof Storage?new StorageEvent("storage",c):new CustomEvent(He,{detail:c}))}}function _(S){try{const b=t.getItem(g.value);if(S==null)M(b,null),t.removeItem(g.value);else{const c=P.write(S);b!==c&&(t.setItem(g.value,c),M(b,c))}}catch(b){v(b)}}function V(S){const b=S?S.newValue:t.getItem(g.value);if(b==null)return l&&E!=null&&t.setItem(g.value,P.write(E)),E;if(!S&&u){const c=P.read(b);return typeof u=="function"?u(c,E):N==="object"&&!Array.isArray(c)?{...E,...c}:c}else return typeof b!="string"?b:P.read(b)}function F(S){if(!(S&&S.storageArea!==t)){if(S&&S.key==null){y.value=E;return}if(!(S&&S.key!==g.value)){C();try{(S==null?void 0:S.newValue)!==P.write(y.value)&&(y.value=V(S))}catch(b){v(b)}finally{S?st(A):A()}}}}function L(S){F(S.detail)}return y}const rn="*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function sn(i={}){const{selector:e="html",attribute:t="class",initialValue:n="auto",window:r=$,storage:o,storageKey:s="vueuse-color-scheme",listenToStorageChanges:a=!0,storageRef:l,emitAuto:u,disableTransition:d=!0}=i,f={auto:"",light:"light",dark:"dark",...i.modes||{}},h=en({window:r}),v=W(()=>h.value?"dark":"light"),p=l||(s==null?Pe(n):Ve(s,n,o,{window:r,listenToStorageChanges:a})),y=W(()=>p.value==="auto"?v.value:p.value),g=mt("updateHTMLAttrs",(C,A,M)=>{const _=typeof C=="string"?r==null?void 0:r.document.querySelector(C):ge(C);if(!_)return;const V=new Set,F=new Set;let L=null;if(A==="class"){const b=M.split(/\s/g);Object.values(f).flatMap(c=>(c||"").split(/\s/g)).filter(Boolean).forEach(c=>{b.includes(c)?V.add(c):F.add(c)})}else L={key:A,value:M};if(V.size===0&&F.size===0&&L===null)return;let S;d&&(S=r.document.createElement("style"),S.appendChild(document.createTextNode(rn)),r.document.head.appendChild(S));for(const b of V)_.classList.add(b);for(const b of F)_.classList.remove(b);L&&_.setAttribute(L.key,L.value),d&&(r.getComputedStyle(S).opacity,document.head.removeChild(S))});function E(C){var A;g(e,t,(A=f[C])!=null?A:C)}function N(C){i.onChanged?i.onChanged(C,E):E(C)}q(y,N,{flush:"post",immediate:!0}),pe(()=>N(y.value));const P=W({get(){return u?p.value:y.value},set(C){p.value=C}});return Object.assign(P,{store:p,system:v,state:y})}function ti(i={}){const{valueDark:e="dark",valueLight:t=""}=i,n=sn({...i,onChanged:(s,a)=>{var l;i.onChanged?(l=i.onChanged)==null||l.call(i,s==="dark",a,s):a(s)},modes:{dark:e,light:t}}),r=W(()=>n.system.value);return W({get(){return n.value==="dark"},set(s){const a=s?"dark":"light";r.value===a?n.value="auto":n.value=a}})}function Se(i){return typeof Window<"u"&&i instanceof Window?i.document.documentElement:typeof Document<"u"&&i instanceof Document?i.documentElement:i}const Ge=1;function on(i,e={}){const{throttle:t=0,idle:n=200,onStop:r=H,onScroll:o=H,offset:s={left:0,right:0,top:0,bottom:0},eventListenerOptions:a={capture:!1,passive:!0},behavior:l="auto",window:u=$,onError:d=_=>{console.error(_)}}=e,f=j(0),h=j(0),v=W({get(){return f.value},set(_){y(_,void 0)}}),p=W({get(){return h.value},set(_){y(void 0,_)}});function y(_,V){var F,L,S,b;if(!u)return;const c=O(i);if(!c)return;(S=c instanceof Document?u.document.body:c)==null||S.scrollTo({top:(F=O(V))!=null?F:p.value,left:(L=O(_))!=null?L:v.value,behavior:O(l)});const m=((b=c==null?void 0:c.document)==null?void 0:b.documentElement)||(c==null?void 0:c.documentElement)||c;v!=null&&(f.value=m.scrollLeft),p!=null&&(h.value=m.scrollTop)}const g=j(!1),E=Be({left:!0,right:!1,top:!0,bottom:!1}),N=Be({left:!1,right:!1,top:!1,bottom:!1}),P=_=>{g.value&&(g.value=!1,N.left=!1,N.right=!1,N.top=!1,N.bottom=!1,r(_))},C=Bt(P,t+n),A=_=>{var V;if(!u)return;const F=((V=_==null?void 0:_.document)==null?void 0:V.documentElement)||(_==null?void 0:_.documentElement)||ge(_),{display:L,flexDirection:S,direction:b}=getComputedStyle(F),c=b==="rtl"?-1:1,m=F.scrollLeft;N.left=m<f.value,N.right=m>f.value;const w=Math.abs(m*c)<=(s.left||0),I=Math.abs(m*c)+F.clientWidth>=F.scrollWidth-(s.right||0)-Ge;L==="flex"&&S==="row-reverse"?(E.left=I,E.right=w):(E.left=w,E.right=I),f.value=m;let T=F.scrollTop;_===u.document&&!T&&(T=u.document.body.scrollTop),N.top=T<h.value,N.bottom=T>h.value;const k=Math.abs(T)<=(s.top||0),x=Math.abs(T)+F.clientHeight>=F.scrollHeight-(s.bottom||0)-Ge;L==="flex"&&S==="column-reverse"?(E.top=x,E.bottom=k):(E.top=k,E.bottom=x),h.value=T},M=_=>{var V;if(!u)return;const F=(V=_.target.documentElement)!=null?V:_.target;A(F),g.value=!0,C(_),o(_)};return B(i,"scroll",t?Jt(M,t,!0,!1):M,a),pe(()=>{try{const _=O(i);if(!_)return;A(_)}catch(_){d(_)}}),B(i,"scrollend",P,a),{x:v,y:p,isScrolling:g,arrivedState:E,directions:N,measure(){const _=O(i);u&&_&&A(_)}}}function ni(i,e,t={}){const{window:n=$}=t;return Ve(i,e,n==null?void 0:n.localStorage,t)}function vt(i){const e=window.getComputedStyle(i);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&i.clientWidth<i.scrollWidth||e.overflowY==="auto"&&i.clientHeight<i.scrollHeight)return!0;{const t=i.parentNode;return!t||t.tagName==="BODY"?!1:vt(t)}}function an(i){const e=i||window.event,t=e.target;return vt(t)?!1:e.touches.length>1?!0:(e.preventDefault&&e.preventDefault(),!1)}const _e=new WeakMap;function ii(i,e=!1){const t=j(e);let n=null,r="";q(Pe(i),a=>{const l=Se(O(a));if(l){const u=l;if(_e.get(u)||_e.set(u,u.style.overflow),u.style.overflow!=="hidden"&&(r=u.style.overflow),u.style.overflow==="hidden")return t.value=!0;if(t.value)return u.style.overflow="hidden"}},{immediate:!0});const o=()=>{const a=Se(O(i));!a||t.value||(Je&&(n=B(a,"touchmove",l=>{an(l)},{passive:!1})),a.style.overflow="hidden",t.value=!0)},s=()=>{const a=Se(O(i));!a||!t.value||(Je&&(n==null||n()),a.style.overflow=r,_e.delete(a),t.value=!1)};return Le(s),W({get(){return t.value},set(a){a?o():s()}})}function ri(i,e,t={}){const{window:n=$}=t;return Ve(i,e,n==null?void 0:n.sessionStorage,t)}function si(i={}){const{window:e=$,...t}=i;return on(e,t)}function oi(i={}){const{window:e=$,initialWidth:t=Number.POSITIVE_INFINITY,initialHeight:n=Number.POSITIVE_INFINITY,listenOrientation:r=!0,includeScrollbar:o=!0,type:s="inner"}=i,a=j(t),l=j(n),u=()=>{if(e)if(s==="outer")a.value=e.outerWidth,l.value=e.outerHeight;else if(s==="visual"&&e.visualViewport){const{width:f,height:h,scale:v}=e.visualViewport;a.value=Math.round(f*v),l.value=Math.round(h*v)}else o?(a.value=e.innerWidth,l.value=e.innerHeight):(a.value=e.document.documentElement.clientWidth,l.value=e.document.documentElement.clientHeight)};u(),pe(u);const d={passive:!0};if(B("resize",u,d),e&&s==="visual"&&e.visualViewport&&B(e.visualViewport,"resize",u,d),r){const f=ht("(orientation: portrait)");q(f,()=>u())}return{width:a,height:l}}/*!
* tabbable 6.2.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var pt=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],de=pt.join(","),gt=typeof Element>"u",Y=gt?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,fe=!gt&&Element.prototype.getRootNode?function(i){var e;return i==null||(e=i.getRootNode)===null||e===void 0?void 0:e.call(i)}:function(i){return i==null?void 0:i.ownerDocument},he=function i(e,t){var n;t===void 0&&(t=!0);var r=e==null||(n=e.getAttribute)===null||n===void 0?void 0:n.call(e,"inert"),o=r===""||r==="true",s=o||t&&e&&i(e.parentNode);return s},ln=function(e){var t,n=e==null||(t=e.getAttribute)===null||t===void 0?void 0:t.call(e,"contenteditable");return n===""||n==="true"},bt=function(e,t,n){if(he(e))return[];var r=Array.prototype.slice.apply(e.querySelectorAll(de));return t&&Y.call(e,de)&&r.unshift(e),r=r.filter(n),r},yt=function i(e,t,n){for(var r=[],o=Array.from(e);o.length;){var s=o.shift();if(!he(s,!1))if(s.tagName==="SLOT"){var a=s.assignedElements(),l=a.length?a:s.children,u=i(l,!0,n);n.flatten?r.push.apply(r,u):r.push({scopeParent:s,candidates:u})}else{var d=Y.call(s,de);d&&n.filter(s)&&(t||!e.includes(s))&&r.push(s);var f=s.shadowRoot||typeof n.getShadowRoot=="function"&&n.getShadowRoot(s),h=!he(f,!1)&&(!n.shadowRootFilter||n.shadowRootFilter(s));if(f&&h){var v=i(f===!0?s.children:f.children,!0,n);n.flatten?r.push.apply(r,v):r.push({scopeParent:s,candidates:v})}else o.unshift.apply(o,s.children)}}return r},wt=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},U=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||ln(e))&&!wt(e)?0:e.tabIndex},un=function(e,t){var n=U(e);return n<0&&t&&!wt(e)?0:n},cn=function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex},St=function(e){return e.tagName==="INPUT"},dn=function(e){return St(e)&&e.type==="hidden"},fn=function(e){var t=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(n){return n.tagName==="SUMMARY"});return t},hn=function(e,t){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===t)return e[n]},mn=function(e){if(!e.name)return!0;var t=e.form||fe(e),n=function(a){return t.querySelectorAll('input[type="radio"][name="'+a+'"]')},r;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")r=n(window.CSS.escape(e.name));else try{r=n(e.name)}catch(s){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",s.message),!1}var o=hn(r,e.form);return!o||o===e},vn=function(e){return St(e)&&e.type==="radio"},pn=function(e){return vn(e)&&!mn(e)},gn=function(e){var t,n=e&&fe(e),r=(t=n)===null||t===void 0?void 0:t.host,o=!1;if(n&&n!==e){var s,a,l;for(o=!!((s=r)!==null&&s!==void 0&&(a=s.ownerDocument)!==null&&a!==void 0&&a.contains(r)||e!=null&&(l=e.ownerDocument)!==null&&l!==void 0&&l.contains(e));!o&&r;){var u,d,f;n=fe(r),r=(u=n)===null||u===void 0?void 0:u.host,o=!!((d=r)!==null&&d!==void 0&&(f=d.ownerDocument)!==null&&f!==void 0&&f.contains(r))}}return o},Ue=function(e){var t=e.getBoundingClientRect(),n=t.width,r=t.height;return n===0&&r===0},bn=function(e,t){var n=t.displayCheck,r=t.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var o=Y.call(e,"details>summary:first-of-type"),s=o?e.parentElement:e;if(Y.call(s,"details:not([open]) *"))return!0;if(!n||n==="full"||n==="legacy-full"){if(typeof r=="function"){for(var a=e;e;){var l=e.parentElement,u=fe(e);if(l&&!l.shadowRoot&&r(l)===!0)return Ue(e);e.assignedSlot?e=e.assignedSlot:!l&&u!==e.ownerDocument?e=u.host:e=l}e=a}if(gn(e))return!e.getClientRects().length;if(n!=="legacy-full")return!0}else if(n==="non-zero-area")return Ue(e);return!1},yn=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if(t.tagName==="FIELDSET"&&t.disabled){for(var n=0;n<t.children.length;n++){var r=t.children.item(n);if(r.tagName==="LEGEND")return Y.call(t,"fieldset[disabled] *")?!0:!r.contains(e)}return!0}t=t.parentElement}return!1},me=function(e,t){return!(t.disabled||he(t)||dn(t)||bn(t,e)||fn(t)||yn(t))},Fe=function(e,t){return!(pn(t)||U(t)<0||!me(e,t))},wn=function(e){var t=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(t)||t>=0)},Sn=function i(e){var t=[],n=[];return e.forEach(function(r,o){var s=!!r.scopeParent,a=s?r.scopeParent:r,l=un(a,s),u=s?i(r.candidates):a;l===0?s?t.push.apply(t,u):t.push(a):n.push({documentOrder:o,tabIndex:l,item:r,isScope:s,content:u})}),n.sort(cn).reduce(function(r,o){return o.isScope?r.push.apply(r,o.content):r.push(o.content),r},[]).concat(t)},_n=function(e,t){t=t||{};var n;return t.getShadowRoot?n=yt([e],t.includeContainer,{filter:Fe.bind(null,t),flatten:!1,getShadowRoot:t.getShadowRoot,shadowRootFilter:wn}):n=bt(e,t.includeContainer,Fe.bind(null,t)),Sn(n)},En=function(e,t){t=t||{};var n;return t.getShadowRoot?n=yt([e],t.includeContainer,{filter:me.bind(null,t),flatten:!0,getShadowRoot:t.getShadowRoot}):n=bt(e,t.includeContainer,me.bind(null,t)),n},Q=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return Y.call(e,de)===!1?!1:Fe(t,e)},Tn=pt.concat("iframe").join(","),Ee=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return Y.call(e,Tn)===!1?!1:me(t,e)};/*!
* focus-trap 7.6.5
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function Oe(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function xn(i){if(Array.isArray(i))return Oe(i)}function In(i,e,t){return(e=Cn(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Nn(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function kn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ye(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function qe(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ye(Object(t),!0).forEach(function(n){In(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Ye(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function Fn(i){return xn(i)||Nn(i)||An(i)||kn()}function On(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function Cn(i){var e=On(i,"string");return typeof e=="symbol"?e:e+""}function An(i,e){if(i){if(typeof i=="string")return Oe(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Oe(i,e):void 0}}var Qe={activateTrap:function(e,t){if(e.length>0){var n=e[e.length-1];n!==t&&n._setPausedState(!0)}var r=e.indexOf(t);r===-1||e.splice(r,1),e.push(t)},deactivateTrap:function(e,t){var n=e.indexOf(t);n!==-1&&e.splice(n,1),e.length>0&&!e[e.length-1]._isManuallyPaused()&&e[e.length-1]._setPausedState(!1)}},Mn=function(e){return e.tagName&&e.tagName.toLowerCase()==="input"&&typeof e.select=="function"},Rn=function(e){return(e==null?void 0:e.key)==="Escape"||(e==null?void 0:e.key)==="Esc"||(e==null?void 0:e.keyCode)===27},ie=function(e){return(e==null?void 0:e.key)==="Tab"||(e==null?void 0:e.keyCode)===9},Dn=function(e){return ie(e)&&!e.shiftKey},Ln=function(e){return ie(e)&&e.shiftKey},Xe=function(e){return setTimeout(e,0)},ne=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return typeof e=="function"?e.apply(void 0,n):e},ae=function(e){return e.target.shadowRoot&&typeof e.composedPath=="function"?e.composedPath()[0]:e.target},zn=[],Pn=function(e,t){var n=(t==null?void 0:t.document)||document,r=(t==null?void 0:t.trapStack)||zn,o=qe({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:Dn,isKeyBackward:Ln},t),s={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,manuallyPaused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},a,l=function(c,m,w){return c&&c[m]!==void 0?c[m]:o[w||m]},u=function(c,m){var w=typeof(m==null?void 0:m.composedPath)=="function"?m.composedPath():void 0;return s.containerGroups.findIndex(function(I){var T=I.container,k=I.tabbableNodes;return T.contains(c)||(w==null?void 0:w.includes(T))||k.find(function(x){return x===c})})},d=function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},w=m.hasFallback,I=w===void 0?!1:w,T=m.params,k=T===void 0?[]:T,x=o[c];if(typeof x=="function"&&(x=x.apply(void 0,Fn(k))),x===!0&&(x=void 0),!x){if(x===void 0||x===!1)return x;throw new Error("`".concat(c,"` was specified but was not a node, or did not return a node"))}var R=x;if(typeof x=="string"){try{R=n.querySelector(x)}catch(D){throw new Error("`".concat(c,'` appears to be an invalid selector; error="').concat(D.message,'"'))}if(!R&&!I)throw new Error("`".concat(c,"` as selector refers to no known node"))}return R},f=function(){var c=d("initialFocus",{hasFallback:!0});if(c===!1)return!1;if(c===void 0||c&&!Ee(c,o.tabbableOptions))if(u(n.activeElement)>=0)c=n.activeElement;else{var m=s.tabbableGroups[0],w=m&&m.firstTabbableNode;c=w||d("fallbackFocus")}else c===null&&(c=d("fallbackFocus"));if(!c)throw new Error("Your focus-trap needs to have at least one focusable element");return c},h=function(){if(s.containerGroups=s.containers.map(function(c){var m=_n(c,o.tabbableOptions),w=En(c,o.tabbableOptions),I=m.length>0?m[0]:void 0,T=m.length>0?m[m.length-1]:void 0,k=w.find(function(D){return Q(D)}),x=w.slice().reverse().find(function(D){return Q(D)}),R=!!m.find(function(D){return U(D)>0});return{container:c,tabbableNodes:m,focusableNodes:w,posTabIndexesFound:R,firstTabbableNode:I,lastTabbableNode:T,firstDomTabbableNode:k,lastDomTabbableNode:x,nextTabbableNode:function(G){var ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,J=m.indexOf(G);return J<0?ee?w.slice(w.indexOf(G)+1).find(function(te){return Q(te)}):w.slice(0,w.indexOf(G)).reverse().find(function(te){return Q(te)}):m[J+(ee?1:-1)]}}}),s.tabbableGroups=s.containerGroups.filter(function(c){return c.tabbableNodes.length>0}),s.tabbableGroups.length<=0&&!d("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(s.containerGroups.find(function(c){return c.posTabIndexesFound})&&s.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},v=function(c){var m=c.activeElement;if(m)return m.shadowRoot&&m.shadowRoot.activeElement!==null?v(m.shadowRoot):m},p=function(c){if(c!==!1&&c!==v(document)){if(!c||!c.focus){p(f());return}c.focus({preventScroll:!!o.preventScroll}),s.mostRecentlyFocusedNode=c,Mn(c)&&c.select()}},y=function(c){var m=d("setReturnFocus",{params:[c]});return m||(m===!1?!1:c)},g=function(c){var m=c.target,w=c.event,I=c.isBackward,T=I===void 0?!1:I;m=m||ae(w),h();var k=null;if(s.tabbableGroups.length>0){var x=u(m,w),R=x>=0?s.containerGroups[x]:void 0;if(x<0)T?k=s.tabbableGroups[s.tabbableGroups.length-1].lastTabbableNode:k=s.tabbableGroups[0].firstTabbableNode;else if(T){var D=s.tabbableGroups.findIndex(function(be){var ye=be.firstTabbableNode;return m===ye});if(D<0&&(R.container===m||Ee(m,o.tabbableOptions)&&!Q(m,o.tabbableOptions)&&!R.nextTabbableNode(m,!1))&&(D=x),D>=0){var G=D===0?s.tabbableGroups.length-1:D-1,ee=s.tabbableGroups[G];k=U(m)>=0?ee.lastTabbableNode:ee.lastDomTabbableNode}else ie(w)||(k=R.nextTabbableNode(m,!1))}else{var J=s.tabbableGroups.findIndex(function(be){var ye=be.lastTabbableNode;return m===ye});if(J<0&&(R.container===m||Ee(m,o.tabbableOptions)&&!Q(m,o.tabbableOptions)&&!R.nextTabbableNode(m))&&(J=x),J>=0){var te=J===s.tabbableGroups.length-1?0:J+1,$e=s.tabbableGroups[te];k=U(m)>=0?$e.firstTabbableNode:$e.firstDomTabbableNode}else ie(w)||(k=R.nextTabbableNode(m))}}else k=d("fallbackFocus");return k},E=function(c){var m=ae(c);if(!(u(m,c)>=0)){if(ne(o.clickOutsideDeactivates,c)){a.deactivate({returnFocus:o.returnFocusOnDeactivate});return}ne(o.allowOutsideClick,c)||c.preventDefault()}},N=function(c){var m=ae(c),w=u(m,c)>=0;if(w||m instanceof Document)w&&(s.mostRecentlyFocusedNode=m);else{c.stopImmediatePropagation();var I,T=!0;if(s.mostRecentlyFocusedNode)if(U(s.mostRecentlyFocusedNode)>0){var k=u(s.mostRecentlyFocusedNode),x=s.containerGroups[k].tabbableNodes;if(x.length>0){var R=x.findIndex(function(D){return D===s.mostRecentlyFocusedNode});R>=0&&(o.isKeyForward(s.recentNavEvent)?R+1<x.length&&(I=x[R+1],T=!1):R-1>=0&&(I=x[R-1],T=!1))}}else s.containerGroups.some(function(D){return D.tabbableNodes.some(function(G){return U(G)>0})})||(T=!1);else T=!1;T&&(I=g({target:s.mostRecentlyFocusedNode,isBackward:o.isKeyBackward(s.recentNavEvent)})),p(I||s.mostRecentlyFocusedNode||f())}s.recentNavEvent=void 0},P=function(c){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;s.recentNavEvent=c;var w=g({event:c,isBackward:m});w&&(ie(c)&&c.preventDefault(),p(w))},C=function(c){(o.isKeyForward(c)||o.isKeyBackward(c))&&P(c,o.isKeyBackward(c))},A=function(c){Rn(c)&&ne(o.escapeDeactivates,c)!==!1&&(c.preventDefault(),a.deactivate())},M=function(c){var m=ae(c);u(m,c)>=0||ne(o.clickOutsideDeactivates,c)||ne(o.allowOutsideClick,c)||(c.preventDefault(),c.stopImmediatePropagation())},_=function(){if(s.active)return Qe.activateTrap(r,a),s.delayInitialFocusTimer=o.delayInitialFocus?Xe(function(){p(f())}):p(f()),n.addEventListener("focusin",N,!0),n.addEventListener("mousedown",E,{capture:!0,passive:!1}),n.addEventListener("touchstart",E,{capture:!0,passive:!1}),n.addEventListener("click",M,{capture:!0,passive:!1}),n.addEventListener("keydown",C,{capture:!0,passive:!1}),n.addEventListener("keydown",A),a},V=function(){if(s.active)return n.removeEventListener("focusin",N,!0),n.removeEventListener("mousedown",E,!0),n.removeEventListener("touchstart",E,!0),n.removeEventListener("click",M,!0),n.removeEventListener("keydown",C,!0),n.removeEventListener("keydown",A),a},F=function(c){var m=c.some(function(w){var I=Array.from(w.removedNodes);return I.some(function(T){return T===s.mostRecentlyFocusedNode})});m&&p(f())},L=typeof window<"u"&&"MutationObserver"in window?new MutationObserver(F):void 0,S=function(){L&&(L.disconnect(),s.active&&!s.paused&&s.containers.map(function(c){L.observe(c,{subtree:!0,childList:!0})}))};return a={get active(){return s.active},get paused(){return s.paused},activate:function(c){if(s.active)return this;var m=l(c,"onActivate"),w=l(c,"onPostActivate"),I=l(c,"checkCanFocusTrap");I||h(),s.active=!0,s.paused=!1,s.nodeFocusedBeforeActivation=v(n),m==null||m();var T=function(){I&&h(),_(),S(),w==null||w()};return I?(I(s.containers.concat()).then(T,T),this):(T(),this)},deactivate:function(c){if(!s.active)return this;var m=qe({onDeactivate:o.onDeactivate,onPostDeactivate:o.onPostDeactivate,checkCanReturnFocus:o.checkCanReturnFocus},c);clearTimeout(s.delayInitialFocusTimer),s.delayInitialFocusTimer=void 0,V(),s.active=!1,s.paused=!1,S(),Qe.deactivateTrap(r,a);var w=l(m,"onDeactivate"),I=l(m,"onPostDeactivate"),T=l(m,"checkCanReturnFocus"),k=l(m,"returnFocus","returnFocusOnDeactivate");w==null||w();var x=function(){Xe(function(){k&&p(y(s.nodeFocusedBeforeActivation)),I==null||I()})};return k&&T?(T(y(s.nodeFocusedBeforeActivation)).then(x,x),this):(x(),this)},pause:function(c){return s.active?(s.manuallyPaused=!0,this._setPausedState(!0,c)):this},unpause:function(c){return s.active?(s.manuallyPaused=!1,r[r.length-1]!==this?this:this._setPausedState(!1,c)):this},updateContainerElements:function(c){var m=[].concat(c).filter(Boolean);return s.containers=m.map(function(w){return typeof w=="string"?n.querySelector(w):w}),s.active&&h(),S(),this}},Object.defineProperties(a,{_isManuallyPaused:{value:function(){return s.manuallyPaused}},_setPausedState:{value:function(c,m){if(s.paused===c)return this;if(s.paused=c,c){var w=l(m,"onPause"),I=l(m,"onPostPause");w==null||w(),V(),S(),I==null||I()}else{var T=l(m,"onUnpause"),k=l(m,"onPostUnpause");T==null||T(),h(),_(),S(),k==null||k()}return this}}}),a.updateContainerElements(e),a};function ai(i,e={}){let t;const{immediate:n,...r}=e,o=j(!1),s=j(!1),a=h=>t&&t.activate(h),l=h=>t&&t.deactivate(h),u=()=>{t&&(t.pause(),s.value=!0)},d=()=>{t&&(t.unpause(),s.value=!1)},f=W(()=>{const h=O(i);return ce(h).map(v=>{const p=O(v);return typeof p=="string"?p:ge(p)}).filter(Lt)});return q(f,h=>{h.length&&(t=Pn(h,{...r,onActivate(){o.value=!0,e.onActivate&&e.onActivate()},onDeactivate(){o.value=!1,e.onDeactivate&&e.onDeactivate()}}),n&&a())},{flush:"post"}),Le(()=>l()),{hasFocus:o,isPaused:s,activate:a,deactivate:l,pause:u,unpause:d}}class Z{constructor(e,t=!0,n=[],r=5e3){this.ctx=e,this.iframes=t,this.exclude=n,this.iframesTimeout=r}static matches(e,t){const n=typeof t=="string"?[t]:t,r=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;if(r){let o=!1;return n.every(s=>r.call(e,s)?(o=!0,!1):!0),o}else return!1}getContexts(){let e,t=[];return typeof this.ctx>"u"||!this.ctx?e=[]:NodeList.prototype.isPrototypeOf(this.ctx)?e=Array.prototype.slice.call(this.ctx):Array.isArray(this.ctx)?e=this.ctx:typeof this.ctx=="string"?e=Array.prototype.slice.call(document.querySelectorAll(this.ctx)):e=[this.ctx],e.forEach(n=>{const r=t.filter(o=>o.contains(n)).length>0;t.indexOf(n)===-1&&!r&&t.push(n)}),t}getIframeContents(e,t,n=()=>{}){let r;try{const o=e.contentWindow;if(r=o.document,!o||!r)throw new Error("iframe inaccessible")}catch{n()}r&&t(r)}isIframeBlank(e){const t="about:blank",n=e.getAttribute("src").trim();return e.contentWindow.location.href===t&&n!==t&&n}observeIframeLoad(e,t,n){let r=!1,o=null;const s=()=>{if(!r){r=!0,clearTimeout(o);try{this.isIframeBlank(e)||(e.removeEventListener("load",s),this.getIframeContents(e,t,n))}catch{n()}}};e.addEventListener("load",s),o=setTimeout(s,this.iframesTimeout)}onIframeReady(e,t,n){try{e.contentWindow.document.readyState==="complete"?this.isIframeBlank(e)?this.observeIframeLoad(e,t,n):this.getIframeContents(e,t,n):this.observeIframeLoad(e,t,n)}catch{n()}}waitForIframes(e,t){let n=0;this.forEachIframe(e,()=>!0,r=>{n++,this.waitForIframes(r.querySelector("html"),()=>{--n||t()})},r=>{r||t()})}forEachIframe(e,t,n,r=()=>{}){let o=e.querySelectorAll("iframe"),s=o.length,a=0;o=Array.prototype.slice.call(o);const l=()=>{--s<=0&&r(a)};s||l(),o.forEach(u=>{Z.matches(u,this.exclude)?l():this.onIframeReady(u,d=>{t(u)&&(a++,n(d)),l()},l)})}createIterator(e,t,n){return document.createNodeIterator(e,t,n,!1)}createInstanceOnIframe(e){return new Z(e.querySelector("html"),this.iframes)}compareNodeIframe(e,t,n){const r=e.compareDocumentPosition(n),o=Node.DOCUMENT_POSITION_PRECEDING;if(r&o)if(t!==null){const s=t.compareDocumentPosition(n),a=Node.DOCUMENT_POSITION_FOLLOWING;if(s&a)return!0}else return!0;return!1}getIteratorNode(e){const t=e.previousNode();let n;return t===null?n=e.nextNode():n=e.nextNode()&&e.nextNode(),{prevNode:t,node:n}}checkIframeFilter(e,t,n,r){let o=!1,s=!1;return r.forEach((a,l)=>{a.val===n&&(o=l,s=a.handled)}),this.compareNodeIframe(e,t,n)?(o===!1&&!s?r.push({val:n,handled:!0}):o!==!1&&!s&&(r[o].handled=!0),!0):(o===!1&&r.push({val:n,handled:!1}),!1)}handleOpenIframes(e,t,n,r){e.forEach(o=>{o.handled||this.getIframeContents(o.val,s=>{this.createInstanceOnIframe(s).forEachNode(t,n,r)})})}iterateThroughNodes(e,t,n,r,o){const s=this.createIterator(t,e,r);let a=[],l=[],u,d,f=()=>({prevNode:d,node:u}=this.getIteratorNode(s),u);for(;f();)this.iframes&&this.forEachIframe(t,h=>this.checkIframeFilter(u,d,h,a),h=>{this.createInstanceOnIframe(h).forEachNode(e,v=>l.push(v),r)}),l.push(u);l.forEach(h=>{n(h)}),this.iframes&&this.handleOpenIframes(a,e,n,r),o()}forEachNode(e,t,n,r=()=>{}){const o=this.getContexts();let s=o.length;s||r(),o.forEach(a=>{const l=()=>{this.iterateThroughNodes(e,a,t,n,()=>{--s<=0&&r()})};this.iframes?this.waitForIframes(a,l):l()})}}let Vn=class{constructor(e){this.ctx=e,this.ie=!1;const t=window.navigator.userAgent;(t.indexOf("MSIE")>-1||t.indexOf("Trident")>-1)&&(this.ie=!0)}set opt(e){this._opt=Object.assign({},{element:"",className:"",exclude:[],iframes:!1,iframesTimeout:5e3,separateWordSearch:!0,diacritics:!0,synonyms:{},accuracy:"partially",acrossElements:!1,caseSensitive:!1,ignoreJoiners:!1,ignoreGroups:0,ignorePunctuation:[],wildcards:"disabled",each:()=>{},noMatch:()=>{},filter:()=>!0,done:()=>{},debug:!1,log:window.console},e)}get opt(){return this._opt}get iterator(){return new Z(this.ctx,this.opt.iframes,this.opt.exclude,this.opt.iframesTimeout)}log(e,t="debug"){const n=this.opt.log;this.opt.debug&&typeof n=="object"&&typeof n[t]=="function"&&n[t](`mark.js: ${e}`)}escapeStr(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}createRegExp(e){return this.opt.wildcards!=="disabled"&&(e=this.setupWildcardsRegExp(e)),e=this.escapeStr(e),Object.keys(this.opt.synonyms).length&&(e=this.createSynonymsRegExp(e)),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),this.opt.diacritics&&(e=this.createDiacriticsRegExp(e)),e=this.createMergedBlanksRegExp(e),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.createJoinersRegExp(e)),this.opt.wildcards!=="disabled"&&(e=this.createWildcardsRegExp(e)),e=this.createAccuracyRegExp(e),e}createSynonymsRegExp(e){const t=this.opt.synonyms,n=this.opt.caseSensitive?"":"i",r=this.opt.ignoreJoiners||this.opt.ignorePunctuation.length?"\0":"";for(let o in t)if(t.hasOwnProperty(o)){const s=t[o],a=this.opt.wildcards!=="disabled"?this.setupWildcardsRegExp(o):this.escapeStr(o),l=this.opt.wildcards!=="disabled"?this.setupWildcardsRegExp(s):this.escapeStr(s);a!==""&&l!==""&&(e=e.replace(new RegExp(`(${this.escapeStr(a)}|${this.escapeStr(l)})`,`gm${n}`),r+`(${this.processSynomyms(a)}|${this.processSynomyms(l)})`+r))}return e}processSynomyms(e){return(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),e}setupWildcardsRegExp(e){return e=e.replace(/(?:\\)*\?/g,t=>t.charAt(0)==="\\"?"?":""),e.replace(/(?:\\)*\*/g,t=>t.charAt(0)==="\\"?"*":"")}createWildcardsRegExp(e){let t=this.opt.wildcards==="withSpaces";return e.replace(/\u0001/g,t?"[\\S\\s]?":"\\S?").replace(/\u0002/g,t?"[\\S\\s]*?":"\\S*")}setupIgnoreJoinersRegExp(e){return e.replace(/[^(|)\\]/g,(t,n,r)=>{let o=r.charAt(n+1);return/[(|)\\]/.test(o)||o===""?t:t+"\0"})}createJoinersRegExp(e){let t=[];const n=this.opt.ignorePunctuation;return Array.isArray(n)&&n.length&&t.push(this.escapeStr(n.join(""))),this.opt.ignoreJoiners&&t.push("\\u00ad\\u200b\\u200c\\u200d"),t.length?e.split(/\u0000+/).join(`[${t.join("")}]*`):e}createDiacriticsRegExp(e){const t=this.opt.caseSensitive?"":"i",n=this.opt.caseSensitive?["aàáảãạăằắẳẵặâầấẩẫậäåāą","AÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćč","CÇĆČ","dđď","DĐĎ","eèéẻẽẹêềếểễệëěēę","EÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïī","IÌÍỈĨỊÎÏĪ","lł","LŁ","nñňń","NÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøō","OÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rř","RŘ","sšśșş","SŠŚȘŞ","tťțţ","TŤȚŢ","uùúủũụưừứửữựûüůū","UÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿ","YÝỲỶỸỴŸ","zžżź","ZŽŻŹ"]:["aàáảãạăằắẳẵặâầấẩẫậäåāąAÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćčCÇĆČ","dđďDĐĎ","eèéẻẽẹêềếểễệëěēęEÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïīIÌÍỈĨỊÎÏĪ","lłLŁ","nñňńNÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøōOÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rřRŘ","sšśșşSŠŚȘŞ","tťțţTŤȚŢ","uùúủũụưừứửữựûüůūUÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿYÝỲỶỸỴŸ","zžżźZŽŻŹ"];let r=[];return e.split("").forEach(o=>{n.every(s=>{if(s.indexOf(o)!==-1){if(r.indexOf(s)>-1)return!1;e=e.replace(new RegExp(`[${s}]`,`gm${t}`),`[${s}]`),r.push(s)}return!0})}),e}createMergedBlanksRegExp(e){return e.replace(/[\s]+/gmi,"[\\s]+")}createAccuracyRegExp(e){const t="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~¡¿";let n=this.opt.accuracy,r=typeof n=="string"?n:n.value,o=typeof n=="string"?[]:n.limiters,s="";switch(o.forEach(a=>{s+=`|${this.escapeStr(a)}`}),r){case"partially":default:return`()(${e})`;case"complementary":return s="\\s"+(s||this.escapeStr(t)),`()([^${s}]*${e}[^${s}]*)`;case"exactly":return`(^|\\s${s})(${e})(?=$|\\s${s})`}}getSeparatedKeywords(e){let t=[];return e.forEach(n=>{this.opt.separateWordSearch?n.split(" ").forEach(r=>{r.trim()&&t.indexOf(r)===-1&&t.push(r)}):n.trim()&&t.indexOf(n)===-1&&t.push(n)}),{keywords:t.sort((n,r)=>r.length-n.length),length:t.length}}isNumeric(e){return Number(parseFloat(e))==e}checkRanges(e){if(!Array.isArray(e)||Object.prototype.toString.call(e[0])!=="[object Object]")return this.log("markRanges() will only accept an array of objects"),this.opt.noMatch(e),[];const t=[];let n=0;return e.sort((r,o)=>r.start-o.start).forEach(r=>{let{start:o,end:s,valid:a}=this.callNoMatchOnInvalidRanges(r,n);a&&(r.start=o,r.length=s-o,t.push(r),n=s)}),t}callNoMatchOnInvalidRanges(e,t){let n,r,o=!1;return e&&typeof e.start<"u"?(n=parseInt(e.start,10),r=n+parseInt(e.length,10),this.isNumeric(e.start)&&this.isNumeric(e.length)&&r-t>0&&r-n>0?o=!0:(this.log(`Ignoring invalid or overlapping range: ${JSON.stringify(e)}`),this.opt.noMatch(e))):(this.log(`Ignoring invalid range: ${JSON.stringify(e)}`),this.opt.noMatch(e)),{start:n,end:r,valid:o}}checkWhitespaceRanges(e,t,n){let r,o=!0,s=n.length,a=t-s,l=parseInt(e.start,10)-a;return l=l>s?s:l,r=l+parseInt(e.length,10),r>s&&(r=s,this.log(`End range automatically set to the max value of ${s}`)),l<0||r-l<0||l>s||r>s?(o=!1,this.log(`Invalid range: ${JSON.stringify(e)}`),this.opt.noMatch(e)):n.substring(l,r).replace(/\s+/g,"")===""&&(o=!1,this.log("Skipping whitespace only range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:l,end:r,valid:o}}getTextNodes(e){let t="",n=[];this.iterator.forEachNode(NodeFilter.SHOW_TEXT,r=>{n.push({start:t.length,end:(t+=r.textContent).length,node:r})},r=>this.matchesExclude(r.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT,()=>{e({value:t,nodes:n})})}matchesExclude(e){return Z.matches(e,this.opt.exclude.concat(["script","style","title","head","html"]))}wrapRangeInTextNode(e,t,n){const r=this.opt.element?this.opt.element:"mark",o=e.splitText(t),s=o.splitText(n-t);let a=document.createElement(r);return a.setAttribute("data-markjs","true"),this.opt.className&&a.setAttribute("class",this.opt.className),a.textContent=o.textContent,o.parentNode.replaceChild(a,o),s}wrapRangeInMappedTextNode(e,t,n,r,o){e.nodes.every((s,a)=>{const l=e.nodes[a+1];if(typeof l>"u"||l.start>t){if(!r(s.node))return!1;const u=t-s.start,d=(n>s.end?s.end:n)-s.start,f=e.value.substr(0,s.start),h=e.value.substr(d+s.start);if(s.node=this.wrapRangeInTextNode(s.node,u,d),e.value=f+h,e.nodes.forEach((v,p)=>{p>=a&&(e.nodes[p].start>0&&p!==a&&(e.nodes[p].start-=d),e.nodes[p].end-=d)}),n-=d,o(s.node.previousSibling,s.start),n>s.end)t=s.end;else return!1}return!0})}wrapMatches(e,t,n,r,o){const s=t===0?0:t+1;this.getTextNodes(a=>{a.nodes.forEach(l=>{l=l.node;let u;for(;(u=e.exec(l.textContent))!==null&&u[s]!=="";){if(!n(u[s],l))continue;let d=u.index;if(s!==0)for(let f=1;f<s;f++)d+=u[f].length;l=this.wrapRangeInTextNode(l,d,d+u[s].length),r(l.previousSibling),e.lastIndex=0}}),o()})}wrapMatchesAcrossElements(e,t,n,r,o){const s=t===0?0:t+1;this.getTextNodes(a=>{let l;for(;(l=e.exec(a.value))!==null&&l[s]!=="";){let u=l.index;if(s!==0)for(let f=1;f<s;f++)u+=l[f].length;const d=u+l[s].length;this.wrapRangeInMappedTextNode(a,u,d,f=>n(l[s],f),(f,h)=>{e.lastIndex=h,r(f)})}o()})}wrapRangeFromIndex(e,t,n,r){this.getTextNodes(o=>{const s=o.value.length;e.forEach((a,l)=>{let{start:u,end:d,valid:f}=this.checkWhitespaceRanges(a,s,o.value);f&&this.wrapRangeInMappedTextNode(o,u,d,h=>t(h,a,o.value.substring(u,d),l),h=>{n(h,a)})}),r()})}unwrapMatches(e){const t=e.parentNode;let n=document.createDocumentFragment();for(;e.firstChild;)n.appendChild(e.removeChild(e.firstChild));t.replaceChild(n,e),this.ie?this.normalizeTextNode(t):t.normalize()}normalizeTextNode(e){if(e){if(e.nodeType===3)for(;e.nextSibling&&e.nextSibling.nodeType===3;)e.nodeValue+=e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);else this.normalizeTextNode(e.firstChild);this.normalizeTextNode(e.nextSibling)}}markRegExp(e,t){this.opt=t,this.log(`Searching with expression "${e}"`);let n=0,r="wrapMatches";const o=s=>{n++,this.opt.each(s)};this.opt.acrossElements&&(r="wrapMatchesAcrossElements"),this[r](e,this.opt.ignoreGroups,(s,a)=>this.opt.filter(a,s,n),o,()=>{n===0&&this.opt.noMatch(e),this.opt.done(n)})}mark(e,t){this.opt=t;let n=0,r="wrapMatches";const{keywords:o,length:s}=this.getSeparatedKeywords(typeof e=="string"?[e]:e),a=this.opt.caseSensitive?"":"i",l=u=>{let d=new RegExp(this.createRegExp(u),`gm${a}`),f=0;this.log(`Searching with expression "${d}"`),this[r](d,1,(h,v)=>this.opt.filter(v,u,n,f),h=>{f++,n++,this.opt.each(h)},()=>{f===0&&this.opt.noMatch(u),o[s-1]===u?this.opt.done(n):l(o[o.indexOf(u)+1])})};this.opt.acrossElements&&(r="wrapMatchesAcrossElements"),s===0?this.opt.done(n):l(o[0])}markRanges(e,t){this.opt=t;let n=0,r=this.checkRanges(e);r&&r.length?(this.log("Starting to mark with the following ranges: "+JSON.stringify(r)),this.wrapRangeFromIndex(r,(o,s,a,l)=>this.opt.filter(o,s,a,l),(o,s)=>{n++,this.opt.each(o,s)},()=>{this.opt.done(n)})):this.opt.done(n)}unmark(e){this.opt=e;let t=this.opt.element?this.opt.element:"*";t+="[data-markjs]",this.opt.className&&(t+=`.${this.opt.className}`),this.log(`Removal selector "${t}"`),this.iterator.forEachNode(NodeFilter.SHOW_ELEMENT,n=>{this.unwrapMatches(n)},n=>{const r=Z.matches(n,t),o=this.matchesExclude(n);return!r||o?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},this.opt.done)}};function ui(i){const e=new Vn(i);return this.mark=(t,n)=>(e.mark(t,n),this),this.markRegExp=(t,n)=>(e.markRegExp(t,n),this),this.markRanges=(t,n)=>(e.markRanges(t,n),this),this.unmark=t=>(e.unmark(t),this),this}const jn="ENTRIES",_t="KEYS",Et="VALUES",z="";class Te{constructor(e,t){const n=e._tree,r=Array.from(n.keys());this.set=e,this._type=t,this._path=r.length>0?[{node:n,keys:r}]:[]}next(){const e=this.dive();return this.backtrack(),e}dive(){if(this._path.length===0)return{done:!0,value:void 0};const{node:e,keys:t}=X(this._path);if(X(t)===z)return{done:!1,value:this.result()};const n=e.get(X(t));return this._path.push({node:n,keys:Array.from(n.keys())}),this.dive()}backtrack(){if(this._path.length===0)return;const e=X(this._path).keys;e.pop(),!(e.length>0)&&(this._path.pop(),this.backtrack())}key(){return this.set._prefix+this._path.map(({keys:e})=>X(e)).filter(e=>e!==z).join("")}value(){return X(this._path).node.get(z)}result(){switch(this._type){case Et:return this.value();case _t:return this.key();default:return[this.key(),this.value()]}}[Symbol.iterator](){return this}}const X=i=>i[i.length-1],Wn=(i,e,t)=>{const n=new Map;if(e===void 0)return n;const r=e.length+1,o=r+t,s=new Uint8Array(o*r).fill(t+1);for(let a=0;a<r;++a)s[a]=a;for(let a=1;a<o;++a)s[a*r]=a;return Tt(i,e,t,n,s,1,r,""),n},Tt=(i,e,t,n,r,o,s,a)=>{const l=o*s;e:for(const u of i.keys())if(u===z){const d=r[l-1];d<=t&&n.set(a,[i.get(u),d])}else{let d=o;for(let f=0;f<u.length;++f,++d){const h=u[f],v=s*d,p=v-s;let y=r[v];const g=Math.max(0,d-t-1),E=Math.min(s-1,d+t);for(let N=g;N<E;++N){const P=h!==e[N],C=r[p+N]+ +P,A=r[p+N+1]+1,M=r[v+N]+1,_=r[v+N+1]=Math.min(C,A,M);_<y&&(y=_)}if(y>t)continue e}Tt(i.get(u),e,t,n,r,d,s,a+u)}};class K{constructor(e=new Map,t=""){this._size=void 0,this._tree=e,this._prefix=t}atPrefix(e){if(!e.startsWith(this._prefix))throw new Error("Mismatched prefix");const[t,n]=ve(this._tree,e.slice(this._prefix.length));if(t===void 0){const[r,o]=je(n);for(const s of r.keys())if(s!==z&&s.startsWith(o)){const a=new Map;return a.set(s.slice(o.length),r.get(s)),new K(a,e)}}return new K(t,e)}clear(){this._size=void 0,this._tree.clear()}delete(e){return this._size=void 0,$n(this._tree,e)}entries(){return new Te(this,jn)}forEach(e){for(const[t,n]of this)e(t,n,this)}fuzzyGet(e,t){return Wn(this._tree,e,t)}get(e){const t=Ce(this._tree,e);return t!==void 0?t.get(z):void 0}has(e){const t=Ce(this._tree,e);return t!==void 0&&t.has(z)}keys(){return new Te(this,_t)}set(e,t){if(typeof e!="string")throw new Error("key must be a string");return this._size=void 0,xe(this._tree,e).set(z,t),this}get size(){if(this._size)return this._size;this._size=0;const e=this.entries();for(;!e.next().done;)this._size+=1;return this._size}update(e,t){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;const n=xe(this._tree,e);return n.set(z,t(n.get(z))),this}fetch(e,t){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;const n=xe(this._tree,e);let r=n.get(z);return r===void 0&&n.set(z,r=t()),r}values(){return new Te(this,Et)}[Symbol.iterator](){return this.entries()}static from(e){const t=new K;for(const[n,r]of e)t.set(n,r);return t}static fromObject(e){return K.from(Object.entries(e))}}const ve=(i,e,t=[])=>{if(e.length===0||i==null)return[i,t];for(const n of i.keys())if(n!==z&&e.startsWith(n))return t.push([i,n]),ve(i.get(n),e.slice(n.length),t);return t.push([i,e]),ve(void 0,"",t)},Ce=(i,e)=>{if(e.length===0||i==null)return i;for(const t of i.keys())if(t!==z&&e.startsWith(t))return Ce(i.get(t),e.slice(t.length))},xe=(i,e)=>{const t=e.length;e:for(let n=0;i&&n<t;){for(const o of i.keys())if(o!==z&&e[n]===o[0]){const s=Math.min(t-n,o.length);let a=1;for(;a<s&&e[n+a]===o[a];)++a;const l=i.get(o);if(a===o.length)i=l;else{const u=new Map;u.set(o.slice(a),l),i.set(e.slice(n,n+a),u),i.delete(o),i=u}n+=a;continue e}const r=new Map;return i.set(e.slice(n),r),r}return i},$n=(i,e)=>{const[t,n]=ve(i,e);if(t!==void 0){if(t.delete(z),t.size===0)xt(n);else if(t.size===1){const[r,o]=t.entries().next().value;It(n,r,o)}}},xt=i=>{if(i.length===0)return;const[e,t]=je(i);if(e.delete(t),e.size===0)xt(i.slice(0,-1));else if(e.size===1){const[n,r]=e.entries().next().value;n!==z&&It(i.slice(0,-1),n,r)}},It=(i,e,t)=>{if(i.length===0)return;const[n,r]=je(i);n.set(r+e,t),n.delete(r)},je=i=>i[i.length-1],We="or",Nt="and",Bn="and_not";class re{constructor(e){if((e==null?void 0:e.fields)==null)throw new Error('MiniSearch: option "fields" must be provided');const t=e.autoVacuum==null||e.autoVacuum===!0?ke:e.autoVacuum;this._options={...Ne,...e,autoVacuum:t,searchOptions:{...Ze,...e.searchOptions||{}},autoSuggestOptions:{...Un,...e.autoSuggestOptions||{}}},this._index=new K,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=Me,this.addFields(this._options.fields)}add(e){const{extractField:t,stringifyField:n,tokenize:r,processTerm:o,fields:s,idField:a}=this._options,l=t(e,a);if(l==null)throw new Error(`MiniSearch: document does not have ID field "${a}"`);if(this._idToShortId.has(l))throw new Error(`MiniSearch: duplicate ID ${l}`);const u=this.addDocumentId(l);this.saveStoredFields(u,e);for(const d of s){const f=t(e,d);if(f==null)continue;const h=r(n(f,d),d),v=this._fieldIds[d],p=new Set(h).size;this.addFieldLength(u,v,this._documentCount-1,p);for(const y of h){const g=o(y,d);if(Array.isArray(g))for(const E of g)this.addTerm(v,u,E);else g&&this.addTerm(v,u,g)}}}addAll(e){for(const t of e)this.add(t)}addAllAsync(e,t={}){const{chunkSize:n=10}=t,r={chunk:[],promise:Promise.resolve()},{chunk:o,promise:s}=e.reduce(({chunk:a,promise:l},u,d)=>(a.push(u),(d+1)%n===0?{chunk:[],promise:l.then(()=>new Promise(f=>setTimeout(f,0))).then(()=>this.addAll(a))}:{chunk:a,promise:l}),r);return s.then(()=>this.addAll(o))}remove(e){const{tokenize:t,processTerm:n,extractField:r,stringifyField:o,fields:s,idField:a}=this._options,l=r(e,a);if(l==null)throw new Error(`MiniSearch: document does not have ID field "${a}"`);const u=this._idToShortId.get(l);if(u==null)throw new Error(`MiniSearch: cannot remove document with ID ${l}: it is not in the index`);for(const d of s){const f=r(e,d);if(f==null)continue;const h=t(o(f,d),d),v=this._fieldIds[d],p=new Set(h).size;this.removeFieldLength(u,v,this._documentCount,p);for(const y of h){const g=n(y,d);if(Array.isArray(g))for(const E of g)this.removeTerm(v,u,E);else g&&this.removeTerm(v,u,g)}}this._storedFields.delete(u),this._documentIds.delete(u),this._idToShortId.delete(l),this._fieldLength.delete(u),this._documentCount-=1}removeAll(e){if(e)for(const t of e)this.remove(t);else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new K,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}}discard(e){const t=this._idToShortId.get(e);if(t==null)throw new Error(`MiniSearch: cannot discard document with ID ${e}: it is not in the index`);this._idToShortId.delete(e),this._documentIds.delete(t),this._storedFields.delete(t),(this._fieldLength.get(t)||[]).forEach((n,r)=>{this.removeFieldLength(t,r,this._documentCount,n)}),this._fieldLength.delete(t),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()}maybeAutoVacuum(){if(this._options.autoVacuum===!1)return;const{minDirtFactor:e,minDirtCount:t,batchSize:n,batchWait:r}=this._options.autoVacuum;this.conditionalVacuum({batchSize:n,batchWait:r},{minDirtCount:t,minDirtFactor:e})}discardAll(e){const t=this._options.autoVacuum;try{this._options.autoVacuum=!1;for(const n of e)this.discard(n)}finally{this._options.autoVacuum=t}this.maybeAutoVacuum()}replace(e){const{idField:t,extractField:n}=this._options,r=n(e,t);this.discard(r),this.add(e)}vacuum(e={}){return this.conditionalVacuum(e)}conditionalVacuum(e,t){return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&t,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(()=>{const n=this._enqueuedVacuumConditions;return this._enqueuedVacuumConditions=Me,this.performVacuuming(e,n)}),this._enqueuedVacuum)):this.vacuumConditionsMet(t)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(e),this._currentVacuum)}async performVacuuming(e,t){const n=this._dirtCount;if(this.vacuumConditionsMet(t)){const r=e.batchSize||Ae.batchSize,o=e.batchWait||Ae.batchWait;let s=1;for(const[a,l]of this._index){for(const[u,d]of l)for(const[f]of d)this._documentIds.has(f)||(d.size<=1?l.delete(u):d.delete(f));this._index.get(a).size===0&&this._index.delete(a),s%r===0&&await new Promise(u=>setTimeout(u,o)),s+=1}this._dirtCount-=n}await null,this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null}vacuumConditionsMet(e){if(e==null)return!0;let{minDirtCount:t,minDirtFactor:n}=e;return t=t||ke.minDirtCount,n=n||ke.minDirtFactor,this.dirtCount>=t&&this.dirtFactor>=n}get isVacuuming(){return this._currentVacuum!=null}get dirtCount(){return this._dirtCount}get dirtFactor(){return this._dirtCount/(1+this._documentCount+this._dirtCount)}has(e){return this._idToShortId.has(e)}getStoredFields(e){const t=this._idToShortId.get(e);if(t!=null)return this._storedFields.get(t)}search(e,t={}){const{searchOptions:n}=this._options,r={...n,...t},o=this.executeQuery(e,t),s=[];for(const[a,{score:l,terms:u,match:d}]of o){const f=u.length||1,h={id:this._documentIds.get(a),score:l*f,terms:Object.keys(d),queryTerms:u,match:d};Object.assign(h,this._storedFields.get(a)),(r.filter==null||r.filter(h))&&s.push(h)}return e===re.wildcard&&r.boostDocument==null||s.sort(tt),s}autoSuggest(e,t={}){t={...this._options.autoSuggestOptions,...t};const n=new Map;for(const{score:o,terms:s}of this.search(e,t)){const a=s.join(" "),l=n.get(a);l!=null?(l.score+=o,l.count+=1):n.set(a,{score:o,terms:s,count:1})}const r=[];for(const[o,{score:s,terms:a,count:l}]of n)r.push({suggestion:o,terms:a,score:s/l});return r.sort(tt),r}get documentCount(){return this._documentCount}get termCount(){return this._index.size}static loadJSON(e,t){if(t==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(e),t)}static async loadJSONAsync(e,t){if(t==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJSAsync(JSON.parse(e),t)}static getDefault(e){if(Ne.hasOwnProperty(e))return Ie(Ne,e);throw new Error(`MiniSearch: unknown option "${e}"`)}static loadJS(e,t){const{index:n,documentIds:r,fieldLength:o,storedFields:s,serializationVersion:a}=e,l=this.instantiateMiniSearch(e,t);l._documentIds=le(r),l._fieldLength=le(o),l._storedFields=le(s);for(const[u,d]of l._documentIds)l._idToShortId.set(d,u);for(const[u,d]of n){const f=new Map;for(const h of Object.keys(d)){let v=d[h];a===1&&(v=v.ds),f.set(parseInt(h,10),le(v))}l._index.set(u,f)}return l}static async loadJSAsync(e,t){const{index:n,documentIds:r,fieldLength:o,storedFields:s,serializationVersion:a}=e,l=this.instantiateMiniSearch(e,t);l._documentIds=await ue(r),l._fieldLength=await ue(o),l._storedFields=await ue(s);for(const[d,f]of l._documentIds)l._idToShortId.set(f,d);let u=0;for(const[d,f]of n){const h=new Map;for(const v of Object.keys(f)){let p=f[v];a===1&&(p=p.ds),h.set(parseInt(v,10),await ue(p))}++u%1e3===0&&await kt(0),l._index.set(d,h)}return l}static instantiateMiniSearch(e,t){const{documentCount:n,nextId:r,fieldIds:o,averageFieldLength:s,dirtCount:a,serializationVersion:l}=e;if(l!==1&&l!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");const u=new re(t);return u._documentCount=n,u._nextId=r,u._idToShortId=new Map,u._fieldIds=o,u._avgFieldLength=s,u._dirtCount=a||0,u._index=new K,u}executeQuery(e,t={}){if(e===re.wildcard)return this.executeWildcardQuery(t);if(typeof e!="string"){const h={...t,...e,queries:void 0},v=e.queries.map(p=>this.executeQuery(p,h));return this.combineResults(v,h.combineWith)}const{tokenize:n,processTerm:r,searchOptions:o}=this._options,s={tokenize:n,processTerm:r,...o,...t},{tokenize:a,processTerm:l}=s,f=a(e).flatMap(h=>l(h)).filter(h=>!!h).map(Gn(s)).map(h=>this.executeQuerySpec(h,s));return this.combineResults(f,s.combineWith)}executeQuerySpec(e,t){const n={...this._options.searchOptions,...t},r=(n.fields||this._options.fields).reduce((y,g)=>({...y,[g]:Ie(n.boost,g)||1}),{}),{boostDocument:o,weights:s,maxFuzzy:a,bm25:l}=n,{fuzzy:u,prefix:d}={...Ze.weights,...s},f=this._index.get(e.term),h=this.termResults(e.term,e.term,1,e.termBoost,f,r,o,l);let v,p;if(e.prefix&&(v=this._index.atPrefix(e.term)),e.fuzzy){const y=e.fuzzy===!0?.2:e.fuzzy,g=y<1?Math.min(a,Math.round(e.term.length*y)):y;g&&(p=this._index.fuzzyGet(e.term,g))}if(v)for(const[y,g]of v){const E=y.length-e.term.length;if(!E)continue;p==null||p.delete(y);const N=d*y.length/(y.length+.3*E);this.termResults(e.term,y,N,e.termBoost,g,r,o,l,h)}if(p)for(const y of p.keys()){const[g,E]=p.get(y);if(!E)continue;const N=u*y.length/(y.length+E);this.termResults(e.term,y,N,e.termBoost,g,r,o,l,h)}return h}executeWildcardQuery(e){const t=new Map,n={...this._options.searchOptions,...e};for(const[r,o]of this._documentIds){const s=n.boostDocument?n.boostDocument(o,"",this._storedFields.get(r)):1;t.set(r,{score:s,terms:[],match:{}})}return t}combineResults(e,t=We){if(e.length===0)return new Map;const n=t.toLowerCase(),r=Jn[n];if(!r)throw new Error(`Invalid combination operator: ${t}`);return e.reduce(r)||new Map}toJSON(){const e=[];for(const[t,n]of this._index){const r={};for(const[o,s]of n)r[o]=Object.fromEntries(s);e.push([t,r])}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:e,serializationVersion:2}}termResults(e,t,n,r,o,s,a,l,u=new Map){if(o==null)return u;for(const d of Object.keys(s)){const f=s[d],h=this._fieldIds[d],v=o.get(h);if(v==null)continue;let p=v.size;const y=this._avgFieldLength[h];for(const g of v.keys()){if(!this._documentIds.has(g)){this.removeTerm(h,g,t),p-=1;continue}const E=a?a(this._documentIds.get(g),t,this._storedFields.get(g)):1;if(!E)continue;const N=v.get(g),P=this._fieldLength.get(g)[h],C=Hn(N,p,this._documentCount,P,y,l),A=n*r*f*E*C,M=u.get(g);if(M){M.score+=A,Yn(M.terms,e);const _=Ie(M.match,t);_?_.push(d):M.match[t]=[d]}else u.set(g,{score:A,terms:[e],match:{[t]:[d]}})}}return u}addTerm(e,t,n){const r=this._index.fetch(n,nt);let o=r.get(e);if(o==null)o=new Map,o.set(t,1),r.set(e,o);else{const s=o.get(t);o.set(t,(s||0)+1)}}removeTerm(e,t,n){if(!this._index.has(n)){this.warnDocumentChanged(t,e,n);return}const r=this._index.fetch(n,nt),o=r.get(e);o==null||o.get(t)==null?this.warnDocumentChanged(t,e,n):o.get(t)<=1?o.size<=1?r.delete(e):o.delete(t):o.set(t,o.get(t)-1),this._index.get(n).size===0&&this._index.delete(n)}warnDocumentChanged(e,t,n){for(const r of Object.keys(this._fieldIds))if(this._fieldIds[r]===t){this._options.logger("warn",`MiniSearch: document with ID ${this._documentIds.get(e)} has changed before removal: term "${n}" was not present in field "${r}". Removing a document after it has changed can corrupt the index!`,"version_conflict");return}}addDocumentId(e){const t=this._nextId;return this._idToShortId.set(e,t),this._documentIds.set(t,e),this._documentCount+=1,this._nextId+=1,t}addFields(e){for(let t=0;t<e.length;t++)this._fieldIds[e[t]]=t}addFieldLength(e,t,n,r){let o=this._fieldLength.get(e);o==null&&this._fieldLength.set(e,o=[]),o[t]=r;const a=(this._avgFieldLength[t]||0)*n+r;this._avgFieldLength[t]=a/(n+1)}removeFieldLength(e,t,n,r){if(n===1){this._avgFieldLength[t]=0;return}const o=this._avgFieldLength[t]*n-r;this._avgFieldLength[t]=o/(n-1)}saveStoredFields(e,t){const{storeFields:n,extractField:r}=this._options;if(n==null||n.length===0)return;let o=this._storedFields.get(e);o==null&&this._storedFields.set(e,o={});for(const s of n){const a=r(t,s);a!==void 0&&(o[s]=a)}}}re.wildcard=Symbol("*");const Ie=(i,e)=>Object.prototype.hasOwnProperty.call(i,e)?i[e]:void 0,Jn={[We]:(i,e)=>{for(const t of e.keys()){const n=i.get(t);if(n==null)i.set(t,e.get(t));else{const{score:r,terms:o,match:s}=e.get(t);n.score=n.score+r,n.match=Object.assign(n.match,s),et(n.terms,o)}}return i},[Nt]:(i,e)=>{const t=new Map;for(const n of e.keys()){const r=i.get(n);if(r==null)continue;const{score:o,terms:s,match:a}=e.get(n);et(r.terms,s),t.set(n,{score:r.score+o,terms:r.terms,match:Object.assign(r.match,a)})}return t},[Bn]:(i,e)=>{for(const t of e.keys())i.delete(t);return i}},Kn={k:1.2,b:.7,d:.5},Hn=(i,e,t,n,r,o)=>{const{k:s,b:a,d:l}=o;return Math.log(1+(t-e+.5)/(e+.5))*(l+i*(s+1)/(i+s*(1-a+a*n/r)))},Gn=i=>(e,t,n)=>{const r=typeof i.fuzzy=="function"?i.fuzzy(e,t,n):i.fuzzy||!1,o=typeof i.prefix=="function"?i.prefix(e,t,n):i.prefix===!0,s=typeof i.boostTerm=="function"?i.boostTerm(e,t,n):1;return{term:e,fuzzy:r,prefix:o,termBoost:s}},Ne={idField:"id",extractField:(i,e)=>i[e],stringifyField:(i,e)=>i.toString(),tokenize:i=>i.split(qn),processTerm:i=>i.toLowerCase(),fields:void 0,searchOptions:void 0,storeFields:[],logger:(i,e)=>{typeof(console==null?void 0:console[i])=="function"&&console[i](e)},autoVacuum:!0},Ze={combineWith:We,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:Kn},Un={combineWith:Nt,prefix:(i,e,t)=>e===t.length-1},Ae={batchSize:1e3,batchWait:10},Me={minDirtFactor:.1,minDirtCount:20},ke={...Ae,...Me},Yn=(i,e)=>{i.includes(e)||i.push(e)},et=(i,e)=>{for(const t of e)i.includes(t)||i.push(t)},tt=({score:i},{score:e})=>e-i,nt=()=>new Map,le=i=>{const e=new Map;for(const t of Object.keys(i))e.set(parseInt(t,10),i[t]);return e},ue=async i=>{const e=new Map;let t=0;for(const n of Object.keys(i))e.set(parseInt(n,10),i[n]),++t%1e3===0&&await kt(0);return e},kt=i=>new Promise(e=>setTimeout(e,i)),qn=/[\n\r\p{Z}\p{P}]+/u;export{re as M,ti as a,ht as b,oi as c,si as d,ii as e,ai as f,Zn as g,ri as h,ni as i,B as j,ui as k,ei as o,en as u,Xn as w};
